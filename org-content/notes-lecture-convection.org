#+Title: 400A - Convection & MLT
#+author: Mathieu Renzo
#+email: mrenzo@arizona.edu

* Energy transport in stars 2/2
*Materials*: Kippenhahn's book Ch. 6, Cox & Giuli vol. 1 Ch. 14,
 Schwarzschild Ch. 7, [[https://ui.adsabs.harvard.edu/abs/2022ApJS..262...19J/abstract][Jermyn et al. 2022]], [[https://ui.adsabs.harvard.edu/abs/2022ApJ...926..169A/abstract][Anders et al. 2022]], [[http://online.kitp.ucsb.edu/online/stars17/cantiello2][Matteo
 Cantiello's talk at KITP in 2017]]

In the [[./notes-lecture-ETransport.org][previous lecture on energy transport]] we have dealt with the
situation where energy diffusion (carried by photons, i.e., radiative
energy transport, or carried by electrons, i.e., conductive energy
transport) is sufficient to sustain the star. However, this is /not/
always the case! For example, we know this is not the case in the
outer layers of the Sun, we can [[https://apod.nasa.gov/apod/ap200203.html][directly see that]]:

[[https://youtu.be/CCzl0quTDHw?si=RUwZfN5SrO1abD1Y][Sun granules]]

We can also see this is not the case in the envelopes of red
supergiants, as for example Betelgeuse, VY Canis Majoris, etc. Less
directly, we can also infer this to happen in the cores of massive
stars: /some stellar layers are not stably stratified and energy
transport is not only diffusive/.

* Convection

In this lecture we will deal with convection, which allows for /energy
transport through macroscopic motion of matter/ resulting in a
/non-zero energy flux with a zero matter flux/.

Convection involves turbulence (the "last" open problem of classical
physics), and is because of this inherently multi-dimensional. Because
of this, convection is usually one of the most approximate ingredients
in stellar calculations, and often the root of many open problems.

Convection is a /thermal/ instability (as we will see it kicks in if the
temperature gradient is steeper than some threshold condition), and it
is a phenomenon that is /not/ unique to stars: the monsoon clouds in
Tucson's summer are also manifestation of convection in the Earth
atmosphere!

Before discussing the details of the physics of convection by using
oversimplified pictures dating back to [[https://en.wikipedia.org/wiki/Ludwig_Prandtl][Prandtl]], have a look at the
following animations of multi-dimensional simulations of convection,
these are probably/hopefully closer to reality than many of the
oversimplifications we will use later in this lecture.

It is important to keep in mind that we adopt modeling simplifications
to make the simulation of stars tractable, but these introduce
systematic uncertainties which are active topic of research.

** Core convection in a massive star ([[https://ui.adsabs.harvard.edu/abs/2022ApJ...926..169A/abstract][Anders et al. 2022]])

  [[https://vimeo.com/684826914]]

  This is a simulation of the temperature fluctuations (right) and
  vertical velocities (left) in "code units" using the code [[https://github.com/DedalusProject/dedalus][Dedalus]].

** Envelope convection in a red super-giant ([[https://ui.adsabs.harvard.edu/abs/2022ApJ...929..156G/abstract][Goldberg et al. 2022]])

 [[https://youtu.be/Cq5EqDkXFhQ]]

 This is a 3D radiation-hydrodynamics simulation of large portions of
 the envelope of a red supergiant (not that different from
 Betelgeuse), computed with the [[https://www.athena-astro.app/][ATHENA++]] code.

** Thermonuclear runaway during a Nova explosion ([[https://ui.adsabs.harvard.edu/abs/2018A%26A...619A.121C/abstract][Casanova et al. 2018]])

 [[./images/125M-ONe-3.wmv]]

 This is a 2D simulation of convection developing during a nova
 explosion using the [[https://flash.rochester.edu/site/][FLASH]] code. The movie shows the (log_{10}) mass
 fraction of neon 20, and is taken from [[http://www.fen.upc.edu/users/jjose/][J. Jordi's personal webpage]]
 (one of the co-authors).

* The timescale for convection

We can define a timescale associated to the macroscopic motion of
matter with net zero flux that is carrying energy \tau_{conv} = \Delta r/v_{conv}.
This is the "convective turnover timescale", where \Delta r is the spatial
extent of a convective region, and v_{conv} is the velocity of the blobs
of matter moving around.

In the following we will see how to find \Delta r and get an estimate of
v_{conv}.

:Question:
- *Q*: We have already encountered two /global/ timescales relevant to
  stars, the free fall timescale \tau_{ff} and the Kelvin-Helmholtz
  timescale \tau_{KH}. \tau_{conv} is instead a /local/ timescale, relevant only
  to the convective layers. How do you think it compares to the two
  global timescales we have defined?
:end:

Since convection is an /instability/ we expect that it kicks in when the
stability of the matter stratification and transport of energy by the
other mechanisms we have already discussed breaks down: /convection
occurs if energy diffusion is insufficient to carry the flux/.

How convection exactly turns on/off and especially how to treat this
in stellar evolution models is still a debated issue - but we can
construct a [[*Convective stability criterion: Schwarzschild & Ledoux criterion][stability criterion]], which when violated means we expect
convection to develop, and [[*Mixing length theory][later on]] we will develop a theoretical
model for the time- and spatially- averaged steady state which we
expect to develop when the convective instability saturates.
Hopefully, stellar /evolution/ timescales are long enough that
describing the averaged steady state resulting from convection is
sufficient for our purposes (but there are exceptions, for example
during explosions of when looking at phenomena on timescales shorter
than \tau_{conv}).

* Convective stability criterion: Schwarzschild & Ledoux criterion

#+CAPTION: Skematic picture of the convective stability based on Prandtl oversimplified "bubble picture". The right panel shows the gradients. This is Fig. 5.3 in Onno Pols' lecture notes.
#+ATTR_HTML: :width 100%
[[./images/conv_blobs.png]]

To derive a stability criterion, let's assume to start from a stable
situation, where the temperature gradient is determined by the
(radiative) diffusion of energy: dT/dr \propto \kappa L/(4\pi r^{2}).

Let's consider a parcel of gas initially in equilibrium with its
surroundings at pressure P_{1} and density \rho_{1}. To determine a stability
criterion, let's perturb such parcel by displacing it by a certain
(small) amount \ell and discuss how the parcel reacts: if things act to
move the parcel of gas back towards its original position we have a
stable situation, if instead a seed initial displacement \ell result in
more displacement, we have an unstable situation.

As the gas parcel moves, we can assume it maintains hydrostatic
equilibrium with the surrounding: we are looking for a thermal
instability that acts on a longer timescale than dynamical timescale.
Moreover, if this were not the case, any pressure imbalance would be
equalized through sound-waves. Therefore, throughout the path \ell and at
the final position we have P_{bubble} = P_{environment}.

Let's calculate the density. Since we assume \ell to be "small" (w.r.t.
the relevant spatial scales in the star), a first order approximation
is sufficient: \rho_{bubble} = \rho_{1} + (d\rho/dr)_{ad} \ell. The relevant way to calculate
d\rho/dr here is to assume that the gas parcel moves /adiabatically/: there
is no time for heat exchange, dq=0, and the specific entropy of the
bubble remains constant ds = 0 (recall thermodynamics!).

We want to compare \rho_{bubble} after the displacement by \ell to the
environment density. Once again we can use a first order
approximation, but for the environment we have assumed an initially
stable stratification, meaning d\rho/dr is not adiabatic, but the
radiative gradient (which you can obtain from dT/dr for radiative
transport and the EOS). Therefore \rho_{2} = \rho_{1} + (d\rho/dr)_{rad }\ell.

** Instability condition
Comparing the density of the displaced bubble \rho_{bubble} to the density of the
environment \rho_{2} we can determine a condition for instability. If
\rho_{Bubble} \leq \rho_{2} then there will be a buoyant force acting to
displace it further up (Archimedes force, the bubble displaces a
volume of fluid heavier than its own weight!):


#+begin_latex
\begin{equation}
\rho_\mathrm{Bubble} \leq \rho_{2}  \Rightarrow
\left(\frac{d\rho}{dr}\right)_\mathrm{ad} \leq
\left(\frac{d\rho}{dr}\right)_\mathrm{env} \equiv \left(\frac{d\rho}{dr}\right)_\mathrm{rad}
\end{equation}
#+end_latex

* Mixing length theory

** Convective velocity vs. thermal velocity

* Limitations of MLT

** Convective boundary mixing (a.k.a. "overshooting")

** Time-dependence
