#+title: 400A - CMD & HRD
#+author: Mathieu Renzo
#+email: mrenzo@arizona.edu

* How can we study things that evolve too slow for us to see?
*Materials*: chapter 1 of Onno Pols' lecture notes, Sec. 30.2 of
Kippehahn book, Sec. 8.2 of Ostie & Carroll book.

** Population studies
We can look at large samples and try to infer lifetimes from how many
individual stars we find in each subset of the population.

Classically, we divide stars in populations based on their chemical
composition and dynamical status (w.r.t. the Galactic potential)

 - *Population I*: these are relatively high metallicity (\simeq Z_{\odot}\simeq
   0.0146) stars in the galactic disk. They are all dynamically cold
   (meaning their orbital velocity follows closely the Keplerian
   rotation curve around the Galactic center, with very small
   deviations from this). These are forming form gas enriched in
   metals by previous generations of stars.
 - *Population II*: these are typically stars in the Galactic halo with
   lower metallicity, but higher dynamical temperature, meaning their
   orbit are not following the Galactic disk Keplerian motion. In
   fact, they are not in the Galactic disk by definition, but rather
   form a quasi-spherical halo in the Galaxy.

The distinction between these two population is however a bit outdated
and not very used in research anymore. Within the Galaxy, it is more
common to distinguish stellar populations based on their dynamical
status (which correlates with how long they have orbited the Galaxy,
and thus age) and the abundance of \alpha elements relative to their iron
content (so a more specific criterion). One term that instead is still
widely present in the literature is:

 - *Population III*: these are /hypothetical/ stars that have not yet been
   observed, formed by metal-free primordial gas composed only of
   hydrogen and helium (and maybe traces of Li and Be) formed at the
   Big Bang. These stars should exist, but they are so far out of
   reach for our telescopes. /JWST/ may be able to see the integrated
   light of populations of these primordial stars in some very high
   redshift young galaxy, or maybe their explosions. Because of the
   quasi-complete lack of metals, Pop III stars are expected to
   possibly be more massive on average (so called top-heavy initial
   mass function). Although they have not been observed, these are
   still receiving much theoretical attention because of their
   potential role during the epoch of reionization, as parents of the
   super-massive black holes in the center of Galaxies, and as the
   stars that kick started the production of chemical elements.

** Observational color-magnitude diagram

#+CAPTION: /Gaia/ DR2 color magnitude diagram
#+ATTR_HTML: :width 100%
#+ATTR_HTML: :alt [[https://sci.esa.int/web/gaia/-/60198-gaia-hertzsprung-russell-diagram][Gaia DR2 CMD]]
[[./images/Gaia_DR2_HRD_Gaia.png]]

This is an example of an observational color-magnitude diagram from
the second /Gaia/ data release, /Gaia/ DR2 in 2018. /Gaia/ is an ESA space
mission to detect with great accuracy parallax and proper motion of >1
billion stars in the Galaxy. This is a very "classical" astrophysics
task, but the precision and size of the datasets from this mission are
unprecedented and are revolutionizing this field.

The y-axis is the magnitude in the =G= band of the telescope. This is a
measure of how many photons in each band (think of it as a "photon
bucket") arrive at the telescope. It is "absolute" because it is
rescaled to what the flux would be if the star were at a distance of
10 parsec.

The x-axis is the color, obtained as the difference in flux between
two filters of the /Gaia/ telescope =Bp-Rp=.

Each dot is a different star, but there are so many (~1.5 billions in
/Gaia/ DR2), that in the most crowded region what is plotted is the
density of stars (per unit "pixel" on this plot). So what we are
looking at is a group picture of many different stars, varying in age,
composition, position in the galaxy, etc.

*** Questions:
 - where are the cool stars?
 - where are the bright stars?
 - where do you think the Sun would be on this diagram? (*N.B.:* /Gaia/
   does /not/ look at the Sun, so it is actually not in this plot!)
 - Focusing on where most stars are, can you spot any trend?

** Digression: Spectral types and the letters OBAFGKM(LTY)

This is one of the many nonsense names in astronomy that exist only
for historical reason. Astronomy is a very ancient science (it's
needed to follow the passage of time and decide when planting things,
and to navigate), but it remained separated from physics (i.e., trying
to understand the functioning of the natural world) for a very long
time, with the Aristotelian idea that the "sub-lunar" world and the
super-lunar world were fundamentally different. This idea was
progressively eroded with the "scientific revolution" of the 16^{th}-17^{th
century, and finally astronomy and physics converged into
*astrophysics* with two major breakthroughs:

1. Newton's gravitational law which unified the motion of free falling
   things on Earth with the motion of satellites (Moon around the
   Earth) and Planets
2. The spectroscopic observations of the Sun (and later other stars)
   by Kirchhoff, Bunsen, and Fraunhofer which demonstrated that stars
   are made "of the same stuff" that we find on Earth

Here I want to focus on 2. A spectrum is what one obtains by taking a
source of light and decomposing it in its various frequencies (e.g.,
with a prism, or grating -- think [[https://en.wikipedia.org/wiki/The_Dark_Side_of_the_Moon#/media/File:Dark_Side_of_the_Moon.png][Pink Floyd's Dark side of the moon
cover]]).

This can be done in any wavelength range, for example, X-ray
spectroscopy is an important tool to study binaries with compact
objects such as neutron stars and black holes. However, for most
stars, since we observe them from ground-based observatories, what is
available is the "optical" spectrum, that is a spectrum in the
wavelength rage that can penetrate the Earth's atmosphere, roughly
between ~300-900 nm.

 are classes introduced later for
Brown Dwarves). This is because the temperature of the gas determine
the electron populations in each ion/atom in the stellar atmosphere
and thus how many and which lines can be seen. This is how this
OBAFGKM(LTY) order came to be.

*** A modern view on spectra
The image above of the solar spectrum is pretty, but that is not how
most astrophysicists look at spectra nowadays.

At zeroth-order approximation a star is a black-body with the
characteristic spectrum, that is flux F_{\lambda} as a function of the
wavelength \lambda (or equivalently F_{\nu}\equiv F_{\nu}(\nu) with \nu =
c/\lambda frequency), given by Planck's function:

#+begin tex
F_{\lambda} d\lambda = \frac{2\pi hc^{2}}{\lambda^{5}}\frac{d\lambda}{e^{hc/\lambda k_{B} T} -1}
#+end tex

Note that this only depends on the temperature of the interior T.
Integrating it across all wavelengths one obtain the total flux F \equiv \int
F_{\lambda} d\lambda = \sigma T^{4}, which is the so called /Stefan-Boltzmann
law/.

The black body spectrum produces the "continuum" of an observed
spectrum, and can be thought of the spectrum of light coming
from the stellar interior:

#+CAPTION: Example of black-body spectrum. Credits: Rich Townsend
#+ATTR_HTML: :width 50%
[[./images/Blackbody.png]]

Before this reaches the telescope though, it has to filter through the
stellar atmosphere, which is by definition the region of the star
where there is a net radial flux of photons (as opposed to the
optically thick interior where the distribution of photons direction
is isotropic). It is in this region that absorption lines can form.
There is another filter that matters: the Earth atmosphere. This can
also introduce absorption lines (or even "bands" when the absorbers
are molecules that have many roto-vibration levels close to each other
in energy/frequency/wavelength).

#+CAPTION: Schematic representation of the Sun spectral energy distribution from [[https://www.sciencedirect.com/science/article/pii/B9780443187865000020?via%3Dihub][Wang et al. 2023]].
#+ATTR_HTML: :width 100%
[[./images/sun-SED.jpg]]

Typically, data reduction pipelines are used to remove the "slope" due
to the underlying continuum and focus only on the absorption lines.
This is usually referred to as "continuum normalization". An example
of the final product for the Sun, with some of the ions responsible
for the visible absorption lines annotated is

#+CAPTION: Example of reduced (portion of the) solar spectrum modified from [[https://ui.adsabs.harvard.edu/abs/2021ApJ...919..100V/abstract][Vejar et al. 2021]]
#+ATTR_HTML: :width 100%
[[./images/sun-normalized.png]]


Note the wavelength ranges, they are varying widely from plot to plot.
This is partly because different wavelength regions require different
instruments and data reduction techniques (from \gamma rays to radio even
the typical units use vary depending on historic and/or engineering
choices).

*N.B.:* for an element =X= (e.g., H, He, Li, ...,C, N, Si, Fe, F, ...) the
neutral ion is usually indicated with =XI= (so HI is hydrogen with one
electron bound, HeI is a helium atom with its two electrons), the
first ionization stage - meaning one electron is missing -  is
indicated with =XII= (e.g., HII is hydrogen once ionized, that is a
proton without an electron, HeII is a helium ion with two protons, two
neutrons and one electron only, etc...), and so forth. This is the
convention used in the figure above, where SiI is neutral silicon, FeI
is neutral iron, FeII is once ionized iron, etc.

*** Questions
- Do the units in all these plots match?

** Theoretical Hertzsprung-Russel diagram

Let's get back to the main topic of the lecture, color-magnitude and
Hertzsprung-Russel diagrams. The /Gaia/ color-magnitude diagram on the
top shows on the right y-axis and top x-axis the quantities that
typically stellar modelers use, effective temperature (T_{eff}) on the
x-axis and luminosity L on the y-axis.

The effective temperature is defined as the temperature of a
black-body with the same energy flux as the surface of the star, such
that L=4\pi R^{2} \sigma T_{eff}^{4}, with R the radius of the star, \sigma=2\pi^{5} k_{B}^{4}/15c^{2}h^{3}
Stefan-Boltzmann constant (k_{B} is the Boltzmann constant, c the speed
of light, and h is Planck's constant). Therefore, T_{eff} is an
idealization: the stellar surface actually does not have a sharp
cutoff with a well defined radius R and temperature T_{eff}. Instead, as
one moves outward in the stellar atmosphere, progressively the gas
becomes transparent to different wavelength \lambda of light: in reality
there is a different radius for each wavelength at which one can
observe a star: R \equiv R(\lambda). This is the topic of the stellar atmosphere,
which determines the outer-boundary conditions we need to study the
interior. Throughout the atmosphere, there will be a location where T
= T_{eff}, but there is nothing physically special occurring there!
However, from the interior point-of-view, it is useful to determine at
this idealized location the outer boundary. We can then specify there
the outer boundary condition to solve the stellar structure equations,
which you don't know yet -- but we will derive and write down during
this course.

We can then use these same axes to plot not a collection of different
stars at a given point in time, like in the plot from /Gaia/ above, but
instead if we have a model of how a star evolves (which is what we
want to develop in this course), then we can plot one star as a
function of time! This is necessarily a "theoretical" plot: stellar
timescales are typically so long, that one human life is not
sufficient to observe a star moving through such a plot.

The following is an example of HR diagram for a 15M_{\odot} star from
zero age main sequence (roughly when most of its luminosity is
provided by Hydrogen burning in the core) to the onset of
core-collapse and thus the point where it will go supernova.

#+CAPTION: Hertzsprung-Russell diagram of a 15M_{\odot} stellar model from [[https://www.as.arizona.edu/~mrenzo/materials/Thesis/Renzo_MSc_thesis.pdf][Renzo 2015]]. Note that this is the evolution of *one* star throughout time!
#+ATTR_HTML: :width 100%
#+ATTR_HTML: :alt 15M_{\odot} single stellar evolution track
[[./images/15Msun_thesis.png]]

:Questions:
- *Q*: on this diagram, how does a line for stars at constant radius
  look like?
:end:

** Putting the two together

One can also overplot theoretical tracks from computer-simulated
stellar models and observed samples to infer physical properties of
the observed stars.

*** Example: cluster with isochrone

[[https://www.youtube.com/watch?v=PsS80huL47c][This video]] shows how /HST/ observations of the Globular cluster \Omega
Centauri can be sorted in color and magnitude to create...a
color-magnitude diagram, where all the stars end up along an
isochrone.

An *isochrone* (from iso = "same" + chronos = "time") is the locus of
points occupied by a population of different stars at a given time.
Typically these are used in analyzing clusters, which are in first
approximation co-eval population of stars with the same composition.
Fitting theoretical isochrones (obtained combining many stellar
models of individual stars) is one of the ways in which one can
determine the age of a cluster.

Note that in the first color-magnitude diagram shown above from /Gaia/
DR2 there are no isochrones: that diagram represents all stars
observed across the Galaxy in /Gaia/ DR2, they have very different ages
from each other, and that's why isochrones there would not be very
informative.

Typically isochrones are used on the color-magnitude diagram, but
nothing forbids one to make isochrones on other planes.

#+CAPTION: Example of isochrone fitting with different stellar models for /HST/ observations of the cluster NGC1818 from [[https://ui.adsabs.harvard.edu/abs/2023A%26A...670A..43W/abstract][Wang et al. 2023]]
#+ATTR_HTML: :width 100%
#+ATTR_HTML: :alt /HST/ observations of NGC1818 with isochrone fitting
[[./images/Wang_NGC1818.png]]


Clearly there is a strong correlation between magnitude and color (or
L and T_{eff}) within a co-eval population: most stars are scattered
around a line. This means there is *one single parameter* dominating the
position of stars on the CMD/HRD at least for the longest lived phase
of the evolution. That parameter is *mass* -- and we will see next time
how masses can be measured only in some special cases.

*** Example: 30 Doradus region

#+CAPTION: Color-magnitude diagram of the 30 Doradus region in the LMC overlayed with theoretical stellar tracks (solid black lines), and isochrones (dashed black lines) from [[https://www.aanda.org/10.1051/0004-6361/201833433][Schneider et al. 2018]]
#+ATTR_HTML: :width 100%
#+ATTR_HTML: :alt  VLT/FLAMES observations of 30 Doradus with theoretical stellar evolution tracks and isochrones
[[./images/30Dor_Schneider30_HRD.png]]

This is not a region where all the stars have the same age
necessarily, hence the wider distribution of stars on the HRD.

* Homework

** Make your own CMD
DEADLINE: <2024-09-12 Thu>

*** Aim
Make your own color-magnitude diagram of a selected group of stars.
This is mainly a data-visualization exercise, so try to make your
diagram as informative and useful as possible. Think of a
publication-quality plot (think of the plots shown in class, search in
the literature!), you want it to be good looking for people to want to
use it in their slides, dense in information, and the info should
possibly be layered. You will also need to write a brief paragraph of
description of what is plotted, including the source of data.

You will be using real bleeding edge data from the /Gaia/ mission and
widely used stellar models from [[https://waps.cfa.harvard.edu/MIST/][MIST]]. MIST stands for "MESA Isochrones
and Stellar Tracks": those are models computed with the same code that
is under the hood in =MESA-web= (although the configuration of the code
is most likely not the same): once again, you are going to be using
real tools used by researcher in the field! Challenges encountered in
this exercise are the kind researchers face in their everyday life!

*** Deliverables
  - Color-magnitude diagram/Hertzsprung-Russell diagram.
  - One paragraph of description (i.e., we want you to /interpret/ your
    plot, not just make it!). Make sure to include the source of the
    data, what one should see in the plot, and what it means. Take
    care in distinguishing what is observational data what is
    theoretical modeling.
  - Script to reproduce the plot (we will not run the script, but you
    should make it an habit to "show your code"). If your script has
    dependencies on other files you wrote, we want those too, but mark
    /clearly/ which file is the main one producing the script.

*** Instructions
We will use the latest data release from ESA's /Gaia/ mission, you will
be using a bleeding-edge dataset! These are publicly available in the
[[https://gea.esac.esa.int/archive/][Gaia archive]] or any of the [[https://www.cosmos.esa.int/web/gaia/data-access#PartnerDataCentres][partner data centers]].

  - Go to [[https://gea.esac.esa.int/archive/]] and select the "Search tab"
  - Select the /Gaia/ query you want to make. Feel free to experiment,
    but keep in mind that you will need to briefly explain what it is
    you plot. *Hint 1*: if you are having troubles selecting stars to
    plot based on some (astro)-physical criterion, you can rely on the
    /Gaia/ Catalog of Nearby Stars to plot all the stars within 100pc
    from the Sun described in [[https://www.aanda.org/articles/aa/full_html/2021/05/aa39498-20/aa39498-20.html][this paper]]. The catalog is available for
    download from [[https://cdsarc.cds.unistra.fr/ftp/J/A+A/649/A6/][here]] (see the [[https://cdsarc.cds.unistra.fr/ftp/J/A+A/649/A6/ReadMe][ReadMe]] for the column headers, you
    probably want to download and plot [[https://cdsarc.cds.unistra.fr/ftp/J/A+A/649/A6/table1c.csv][table1c.csv]]). *Hint 2*: you can
    find in papers the queries of the /Gaia/ database for specific
    clusters! For example the cluster NGC6231 can be found using the
    appendix A of [[https://ui.adsabs.harvard.edu/abs/2021A%26A...655A..31V/abstract][this paper]].
  - Download and, if needed, clean the data. Make sure you start with
    a manageable amount. If you want to select a cluster, you may need
    to do parallax cuts.
  - Plot the color-magnitude diagram (suggestion: G-band magnitude on
    the y-axis, BP-RP color on the x-axis).
  - download and plot a bunch of Gaia data. Make the visualization as
    clear as possible.
  - Skim [[https://ui.adsabs.harvard.edu/abs/2016ApJ...823..102C/abstract][Choi et al. 2016]] describing the MIST project (it's ok if you
    don't understand everything, you will have a much better
    understanding by the end of the semester!).
  - Use the [[https://waps.cfa.harvard.edu/MIST/][MIST web interpolator]] to over-plot isochrones on your
    plot. Note that the file you can download has extension =*.iso=, but
    it is /not/ and =iso= image file, just plain text that you can load
    and plot.
  - Use the [[https://waps.cfa.harvard.edu/MIST/][MIST web interpolator]] to over-plot evolutionary tracks.

** Suggested
To follow the next lecture, it will be helpful for you to revise
Kepler's laws, orbital, and celestial mechanics.
