#+title: Lecture 4: Hydrostatic equilibrium
#+author: Mathieu Renzo
#+email: mrenzo@arizona.edu

* The first two equations of stellar structure
*Materials*: chapter 2 of Onno Pols' lecture notes, chapters 1 & 2 of
Kippenhahn's book.

** Spherical symmetry and one dimensional approximation
At zeroth-order, the dynamical elements that determine the structure
of a star are:

 - Gravity: the weight of the gas forming the star itself
 - Pressure: the thermal pressure of the gas, sometimes with
   contribution from the radiation and degeneracy

Gravity is a central force that depends only on the radius (\prop r^{-2}),
and pressure is isotropic. Therefore at zeroth order, we expect stars
to be well approximated as /spheres/. This mathematically means that we
can express all the variables that characterize the structure of a
star as a function of a single variable, for example the radius from
the center of the star. This allows for the calculation of

:Questions:
 - *Q*: Discuss with your neighbor: can you think of cases where a star  may not be spherical?
:end:

** Lagrangian and Eulerian coordinates
In hydrodynamics one is typically interested in describing fields
(e.g., density, velocity, pressure, temperature, etc..). Let's call a
generic field \Psi. It can be described in two ways (well, they can also
be "combined" sometimes).

*** Eulerian description
In a Eulerian description the fields are described as a function of
space (and time): \Psi \equiv \Psi(x,y,z, t) in Cartesian coordinates or \Psi(r, \theta,
\varphi, t) in spherical-polar coordinates.

This is like looking at the flow from on top of a bridge at a fixed
position, describing the variables at that specific position.

#+CAPTION: Eulerian description is like putting many bridges over a fluid and describing the properties as a function of what goes on just below the bridge
#+ATTR_HTML: :width 50%  :alt https://www.flickr.com/photos/frixan/114822407/
[[./images/Eulerian-bridge.jpg]]

For a star assuming spherical symmetry as discussed above, we would
have no dependence on the angular variables \partial_{\theta} \Psi \equiv
\partial_{\varphi}\Psi \equiv 0 and we could express \Psi\equiv\Psi(r, t).

*** Lagrangian description
In a Lagrangian description the fields are described as a function of
the fluid element, following the fluid element itself: \Psi \equiv\Psi(fluid
element, t)

This is like hopping on a boat that moves with the fluid, and
describing the properties of the fluid as the boat moves with it.

#+CAPTION: Lagrangian description is like following the fluid on a boat and describe what goes on as a function of the fluid particle being followed
#+ATTR_HTML: :width 50% :alt https://www.snowaddiction.org/2015/10/the-zen-of-kayaking-i-photograph-the-fjords-of-norway-from-the-kayak-seat.html?m=1
[[./images/Lagrangian_kayak.jpg]]

Because of the extremely large range of spatial scales in stellar
evolution (e.g., in the Sun from the center at r\simeq0 to the outer radius
r\simeq 7\times10^{11} cm, and in its future as a red giant 100-1000x larger),
compared to the limited range in mass (in the appropriate units 0-1
M_{\odot} for the Sun!), typically a Lagrangian description is preferred.
This means, for example we can chose as independent coordinate in the
star not the radius r, but instead the amount of mass enclosed by a
given radius m\equiv m(r), thus express \Psi(r,t) =\Psi(r(m), t)\rightarrow
\Psi(m(r), t).

Derivatives can then be expressed with the chain rule:
\partial/\partial m = \partial/\partial r \times \partial r/\partial m.

This is what is typically done in stellar evolution, and it
works because the m(r) function is invertible, and it is in fact
monotonically increasing: as r increases, the amount of stellar mass
enclosed can also only increase!

:Questions:
 - *Q*: are there other variables that one can use as independent?
:end:

** Mass conservation

Let's consider the amount of mass in a parcel of stellar gas. This will
depend on the local gas density \rho(r, t) (or equivalently in the
Lagrangian formalism \rho(m, t)!) and the amount of volume in the shell

#+begin_latex
dm = \rho dAdr
#+end_latex

where dA is the element base area, and dr its radial thickness. We can
integrate over the base to get the parcel to be a spherical shell

#+begin_latex
\begin{equation}
\int dA = 4\pi r^{2}
\end{equation}
#+end_latex

where r is the radius of the shell, therefore

#+begin_latex
\begin{equation}
dm = 4\pi \rho r^{2} dr \ \ .
\end{equation}
#+end_latex

In principle gas could also flow in/out of the shell at a rate
determined by the inflow/outflow velocity such that in a time interval
dt an amount -\rho v dA dt flows out (for v>0, the quantity is negative)
or in (v<0). Again integrating over dA:

#+begin_latex
\begin{equation}
\label{eq:mass_continuity}
dm = 4\pi \rho r^{2} dr - 4\pi r^{2} \rho v dt \ \ .
\end{equation}
#+end_latex

This is the complete mass continuity equation in spherical symmetry.
From this complete form we can take the partial derivatives w.r.t. r
(at fixed t) and t (at fixed r):

#+begin_latex
\begin{equation}\label{eq:mass_continuity_rt}
\frac{\partial m}{\partial r} = 4\pi r^{2} \rho
\\

\frac{\partial m}{\partial t} = - 4\pi r^{2} \rho v \ \ .
\end{equation}
#+end_latex

We can also derive the first one above w.r.t. t and the bottom one
w.r.t r, and demand the two forms are the same. Since r and t are the
independent variables here, we obtain:

#+begin_latex
\begin{equation}
\frac{\partial \rho}{\partial t} = - \frac{1}{r^{2}}\frac{\partial (r^{2}\rho v)}{\partial r} \Leftrightarrow \frac{\partial \rho}{\partial t} + \nabla\cdot(\rho v) = 0 \ \ ,
\end{equation}
#+end_latex
with \partial_{\theta}\equiv\partial_{\varphi}\equiv 0 for the last one, that is
the typical form of the mass continuity equation in spherical
symmetry.

To turn these equations in the more typical form for
stellar structure, just take the first one in
\ref{eq:mass_continuity_rt} and express it with m as independent
variable:

#+begin_latex
\begin{equation}\label{eq:mass_conservation}
\frac{\partial r}{\partial m} = \frac{1}{4\pi r^{2} \rho} \ \ ,
\end{equation}
#+end_latex

where the partial derivatives become total derivatives in a static
situation (where by definition \partial_{t} = 0). This is the first stellar
structure equation that expresses mass conservation, and it depends on
a yet unknown variable, the gas density \rho.

** Momentum conservation and hydrostatic equilibrium

:Questions:
- *Q*: are stars in hydrostatic equilibrium? How do we know observationally?
:end:

Sonsider the equation of motion of a parcel of stellar gas, F = dp/dt
= ma (for constant m), or often more conveniently in fluid dynamics,
work per unit volume with f = dF/dV and thus f=\rho a with \rho = dm/dV and
dV=dAdr \Rightarrow V=\int dAdr the volume. Let's start by writing down explicitly
the forces that we think are important for a non-rotating,
non-magnetic star.

*** Gravity
Since by definition a star is a self-gravitating body (*N.B.* so is a
planet, that's not the whole definition of a star!), we want to
include the gravitational force on the l.h.s of our f=\rho a equation.
This can be obtained as the gradient of the gravitational potential \Phi
which is a solution of the Poisson equation:

#+begin_latex
\begin{equation}
\nabla^{2} \Phi = 4\pi G\rho \Rightarrow \frac{1}{r^{2}}\frac{\partial}{\partial r}\left(r^{2}\frac{\Phi}{\partial r} \right) = 4\pi G\rho \ \ ,
\end{equation}
#+end_latex

where the second form assumes already spherical symmetry. Note how
this equation does not make the problem worse: we have a new variable
\Phi but the r.h.s. only depends on the density \rho which is already
appearing in Eq. \ref{eq:mass_conservation}.

We can introduce the gravitational acceleration g = - \nabla\Phi, which in
spherical symmetry only has a non-zero radial component \Rightarrow g = - d\Phi/dr
which from Newton's theory of gravity we know to be

#+begin_latex
\begin{equation}
- \nabla \Phi = g \equiv g(m(r))= \frac{Gm(r)}{r^{2}} \ \ ,
\end{equation}
#+end_latex

where m\equiv m(r) is the mass enclosed within a certain radius r, which we
already encountered. The gravitational force acting on a spherical
shell of mass dm = 4\pi r^{2}\rho dr is thus just -gdm = -Gmdm/r^{2}, or per
unit volume f_{grav} = -g\rho = -Gm\rho/r^{2}, where the minus sign is to
explicitly indicate that this force points towards the center of the
star.

*** Pressure gradient
The other contribution we need to include in our f = \rho a equation is
from the pressure. We could already use dimensional analysis to guess
in what form pressure can enter the l.h.s. of the equation:

[P] = [force]/[area] \Rightarrow [P]/[length] = [force]/[volume] \equiv [f]

This suggests that the pressure divided an appropriate length scale
has the right dimension to enter f. This in turn suggests that maybe
what we need is the pressure /gradient/!

Let's have a slightly more formal look at how this work. Because of
spherical symmetry, the pressure in the horizontal direction (which in
stellar context always means in the plane orthogonal to the radial
direction) is perfectly balanced, and the pressure only depends on the
radius P\equiv P(r) (\equiv P(r(m)).

The net force per unit area on each side of a spherical shell of gas
of thickness dr is P(r) at the inner boundary and P(r+dr) at the outer
boundary. Therefore, dF_{press} = P(r)dA - P(r+dr)dA \simeq dP/dr dA where we
used P(r+dr)\simeq P(r)+(dP/dr)dr. Now using dm = \rho drdA and dividing by dV
= drdA we finally obtain f_{press} = - dP/dr.

*** Combining the two

We have now an explicit form for the two most important forces in a
(non-rotating, non-magnetic) star f = f_{grav} + f_{pres} = -g\rho - dP/dr \equiv \rho
a.

Since stars don't change that much on short timescales (we will see
exceptions later, and define relevant timescales too), we can assume
that overall the acceleration a of each parcel of gas is zero in most
cases, that is a=0. /Stars are generally in hydrostatic equilibrium/. In
this case the conservation of momentum becomes

#+begin_latex
\begin{equation}
\frac{dP}{dr} = -g\rho = -\frac{Gm}{r^{2}}\rho \ \ ,
\end{equation}
#+end_latex

or changing to have m has the independent variable, to have a
Lagrangian treatment:

#+begin_latex
\begin{equation}
\frac{dP}{dr} = \frac{dP}{dm}\frac{dm}{dr} = \frac{dP}{dm}4\pi r^{2}\rho
\end{equation}
#+end_latex

and thus

#+begin_latex
\begin{equation}\label{eq:HSE}
\frac{dP}{dm} = -\frac{Gm}{4\pi r^{4}} \ \ ,
\end{equation}
#+end_latex

which is the second stellar structure equation that expresses the fact
that the gravitational pull of the stellar gas is compensated by the
pressure gradient inside the star. This also means that it is the
gravity of the star that imposes the pressure stratification of the
star and ultimately its structure. And finally, the fact that dP/dm<0,
that is the pressure decreases as the enclose mass increases, or
equivalently, the pressure increases towards the center (smaller
radii, smaller amount of enclosed mass) makes sense, if the gradient
has to compensate the gravitational pull.

*N.B.:* This can also be obtained starting from the Navier-Stokes
equation assuming no viscosity (the microscopic viscosity is generally
negligible in stars).


Equations Eq. \ref{eq:mass_conservation} and \ref{eq:HSE} are two
differential equations, that under the assumption of spherical
symmetry are ordinary differential equations (\partial_{r} \rightarrow d/dr),
for the function m\equiv m(r) that depend on P, \rho. We thus have three
variables (m, P, \rho) and two equations: we cannot yet solve for the
structure of a star. We will close the system of equations (meaning,
obtain as many equations as variables, so we can solve for the stellar
structure) later in the course.

*** Estimate for the central pressure

A first estimate for the central pressure can be obtained substituting
the local gradient with the difference from surface to the core across
the entire mass of the star dP/dm \rightarrow (P_{surface} - P_{center})/M \simeq
-P_{center}/M, where we also use P increases inwards and thus it is
legitimate to expect P_{center}\gg P_{surface}. Then, on the l.h.s. of Eq.
\ref{eq:HSE}, we should take as estimates some fraction of the total
mass M and radius R. For the sake of simplicity, let's take the
fraction to be 1 and drop the 4\pi:

#+begin_latex
\begin{equation}
P_\mathrm{center} = \frac{GM^{2}^{}}{R^{4}} \ \ ,
\end{equation}
#+end_latex

Plugging in the numbers for the Sun this gives P_{center}\simeq 10^{16}
dyne/cm^{2}\simeq 10^{10} atmospheres. Although this a is very imprecise
estimate, it already gives the idea that the pressure in the center of
the Sun must be extremely high. See Onno Pols chapter 2 for more
precise estimates and lower bounds.

** Dynamical timescale estimates
Let's say that the star was not in hydrostatic equilibrium, but still
spherically symmetric. Returning to the general form for the momentum
conservation f = \rho a \equiv \rho \partial^{2}r/\partial t^{2} we have

#+begin_latex
\begin{equation}
\rho \frac{\partial^{2} r}{\partial t^{2}} = -\frac{dP}{dr} -\frac{Gm}{r^{2}}\rho \ \ ,
\end{equation}
#+end_latex
where since P decreases inwards, dP/dr<0, so the first term on the
l.h.s. pushes outwards (positive radial acceleration), while gravity
pulls inward, as one would expect.

Normally, for a star, we expect these two terms to balance each other,
but what happens if we turn one off?

*** Explosion timescale
Let's turn off gravity! To estimate how long it takes for the pressure
gradient to push the gas out to a radius comparable to the radius of
the star we can do the following rough substitution in the dynamical
equation above:
 - \partial^{2} r \rightarrow R (outer radius of the star)
 - \partial t^{2} \rightarrow \tau_{expl}^{2}
 - dP/dr\rightarrow P/R with P some averaged pressure in the star
and we obtain:

#+begin_latex
\begin{equation}
\tau_\mathrm{expl} = \frac{R}{\sqrt{\frac{P}{\rho}_{}}} \ \ .
\end{equation}
#+end_latex

:Question:
- *Q*: does anyone recognize


* Homework

Estimate and compare the dynamical timescale using multiple methods:

 - Kepler's third law at the surface of the star
 - Estimate central pressure of the


Using MESA-web make a one M_{\odot} star and plot the m(r)

Using MESA-web, build a grid of ZAMS models and check the L\equiv L(M) scaling
